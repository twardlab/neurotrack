

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>data_prep package &mdash; Neurotrack 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Neurotrack
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Neurotrack</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">data_prep package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/data_prep.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="data-prep-package">
<h1>data_prep package<a class="headerlink" href="#data-prep-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-data_prep.collect">
<span id="data-prep-collect-module"></span><h2>data_prep.collect module<a class="headerlink" href="#module-data_prep.collect" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="data_prep.collect.collect_data">
<span class="sig-prename descclassname"><span class="pre">data_prep.collect.</span></span><span class="sig-name descname"><span class="pre">collect_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.collect.collect_data" title="Link to this definition"></a></dt>
<dd><p>Collect data from images and save labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_points</strong> (<em>dict</em>) – Dictionary whose keys are the file names and values are numpy arrays of random points.</p></li>
<li><p><strong>image_dir</strong> (<em>str</em>) – Directory containing the images.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Directory to save the output data.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Name for the output files.</p></li>
<li><p><strong>date</strong> (<em>str</em>) – Date for the output files.</p></li>
<li><p><strong>rng</strong> (<em>numpy.random.Generator</em><em>, </em><em>optional</em>) – Random number generator for data collection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.collect.swc_random_points">
<span class="sig-prename descclassname"><span class="pre">data_prep.collect.</span></span><span class="sig-name descname"><span class="pre">swc_random_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples_per_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swc_lists</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.collect.swc_random_points" title="Link to this definition"></a></dt>
<dd><p>Choose random points near the neuron coordinates from swc data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples_per_file</strong> (<em>int</em>) – Number of samples to take from each swc file</p></li>
<li><p><strong>swc_lists</strong> (<em>list</em>) – A list of neuron tree data each represented as a list of nodes.</p></li>
<li><p><strong>file_names</strong> (<em>list</em>) – A list of file names corresponding to each swc list in ‘swc_lists’.</p></li>
<li><p><strong>adjust</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the images generated from swc file data preserved swc coordinates as voxel indices or adjusted
the coordinates with relation to voxel indices. Default is False.</p></li>
<li><p><strong>rng</strong> (<em>numpy.random.Generator</em><em>, </em><em>optional</em>) – Sets random number generator for random point selection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sample_points</strong> – Dictionary whose keys are the file names from ‘file_names’ and values are numpy arrays
of random points chosen near the neuron coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-data_prep.data_utils">
<span id="data-prep-data-utils-module"></span><h2>data_prep.data_utils module<a class="headerlink" href="#module-data_prep.data_utils" title="Link to this heading"></a></h2>
<p>Utils.py : Helper functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="data_prep.data_utils.interp">
<span class="sig-prename descclassname"><span class="pre">data_prep.data_utils.</span></span><span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp2d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.data_utils.interp" title="Link to this definition"></a></dt>
<dd><p>Interpolate an image with specified regular voxel locations at specified sample points.</p>
<p>Interpolate the image I, with regular grid positions stored in x (1d arrays),
at the positions stored in phii (3D or 4D arrays with first channel storing component)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>list</em><em> of </em><em>numpy arrays</em>) – x[i] is a numpy array storing the pixel locations of imaging data along the i-th axis.
Note that this MUST be regularly spaced, only the first and last values are queried.</p></li>
<li><p><strong>I</strong> (<em>array</em>) – Numpy array or torch tensor storing 2D or 3D imaging data.  In the 3D case, I is a 4D array with
channels along the first axis and spatial dimensions along the last 3. For 2D, I is a 3D array with
spatial dimensions along the last 2.</p></li>
<li><p><strong>phii</strong> (<em>array</em>) – Numpy array or torch tensor storing positions of the sample points. phii is a 3D or 4D array
with components along the first axis (e.g. x0,x1,x1) and spatial dimensions
along the last axes.</p></li>
<li><p><strong>interp2d</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, interpolates a 2D image, otherwise 3D. Default is False (expects a 3D image).</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – keword arguments to be passed to the grid sample function. For example
to specify interpolation type like nearest.  See pytorch grid_sample documentation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – Array storing an image with channels stored along the first axis.
This is the input image resampled at the points stored in phii.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-data_prep.draw">
<span id="data-prep-draw-module"></span><h2>data_prep.draw module<a class="headerlink" href="#module-data_prep.draw" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="data_prep.draw.draw_neuron">
<span class="sig-prename descclassname"><span class="pre">data_prep.draw.</span></span><span class="sig-name descname"><span class="pre">draw_neuron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_brightness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.draw.draw_neuron" title="Link to this definition"></a></dt>
<dd><p>Draws a neuron image based on provided segments and parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segments</strong> (<em>list</em><em> of </em><em>ndarray</em>) – List of segments where each segment is an ndarray of shape (N, 3) representing the coordinates of the neuron segments.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em> of </em><em>int</em>) – Shape of the output image (height, width).</p></li>
<li><p><strong>width</strong> (<em>int</em>) – Width of the neuron lines to be drawn.</p></li>
<li><p><strong>noise</strong> (<em>float</em>) – Standard deviation of the Gaussian noise to be added to the image.</p></li>
<li><p><strong>neuron_color</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – RGB color of the neuron lines. Each value should be in the range [0, 1]. Default is (1.0, 1.0, 1.0).</p></li>
<li><p><strong>background_color</strong> (<em>tuple</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – RGB color of the background. Each value should be in the range [0, 1]. Default is None.</p></li>
<li><p><strong>random_brightness</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, random brightness will be applied to each segment. Default is False.</p></li>
<li><p><strong>binary</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the image will be binary. Default is False.</p></li>
<li><p><strong>rng</strong> (<em>numpy.random.Generator</em><em>, </em><em>optional</em>) – Random number generator instance. Default is None, which uses numpy’s default_rng.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An Image object containing the drawn neuron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#data_prep.image.Image" title="data_prep.image.Image">Image</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.draw.draw_neuron_density">
<span class="sig-prename descclassname"><span class="pre">data_prep.draw.</span></span><span class="sig-name descname"><span class="pre">draw_neuron_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.draw.draw_neuron_density" title="Link to this definition"></a></dt>
<dd><p>Draws neuron density on an image based on given segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segments</strong> (<em>array-like</em><em> or </em><em>torch.Tensor</em>) – A list or tensor of neuron segments, where each segment is represented by a set of points.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em> of </em><em>int</em>) – The shape of the output density image (height, width, depth).</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – The width of the line segments to be drawn, by default 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An image object with the neuron density drawn on it.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#data_prep.image.Image" title="data_prep.image.Image">Image</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.draw.draw_neuron_mask">
<span class="sig-prename descclassname"><span class="pre">data_prep.draw.</span></span><span class="sig-name descname"><span class="pre">draw_neuron_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.draw.draw_neuron_mask" title="Link to this definition"></a></dt>
<dd><p>Create a binary mask from the neuron density image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> (<em>torch.Tensor</em>) – Neuron density image.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Threshold value for classifying a voxel in the neuron density image as inside the neuron.
The threshold value is relative to the width of the neuron. Specifically, the mask will label
as neuron voxels within one standard deviation from the peak neuron value, where the neuron
intensities are assumed to be normally distributed around the centerline.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.draw.draw_path">
<span class="sig-prename descclassname"><span class="pre">data_prep.draw.</span></span><span class="sig-name descname"><span class="pre">draw_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.draw.draw_path" title="Link to this definition"></a></dt>
<dd><p>Draws a path on the given image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>object</em>) – The image object on which the path will be drawn. It should have a method <cite>draw_line_segment</cite>.</p></li>
<li><p><strong>path</strong> (<em>list</em><em> or </em><em>numpy.ndarray</em><em> or </em><em>torch.Tensor</em>) – The path to be drawn. It can be a list of coordinates, a numpy array, or a torch tensor.</p></li>
<li><p><strong>width</strong> (<em>int</em>) – The width of the line segments to be drawn.</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – If True, the line segments will be drawn in binary mode.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The image object with the path drawn on it.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.draw.draw_section_labels">
<span class="sig-prename descclassname"><span class="pre">data_prep.draw.</span></span><span class="sig-name descname"><span class="pre">draw_section_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.draw.draw_section_labels" title="Link to this definition"></a></dt>
<dd><p>Draws discrete labels for each section on an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sections</strong> (<em>dict</em>) – A dictionary where keys are section labels and values are lists of segments.
Each segment is a numpy array with shape (n, 3) representing the coordinates.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em>) – The shape of the output image (height, width, depth).</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – The width of the line segments to be drawn, by default 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An image object with the drawn sections labeled.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#data_prep.image.Image" title="data_prep.image.Image">Image</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.draw.neuron_from_swc">
<span class="sig-prename descclassname"><span class="pre">data_prep.draw.</span></span><span class="sig-name descname"><span class="pre">neuron_from_swc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swc_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_brightness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.draw.neuron_from_swc" title="Link to this definition"></a></dt>
<dd><p>Generate a neuron image from an SWC list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swc_list</strong> (<em>list</em>) – List of SWC data representing neuron structure.</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the neuron lines, by default 3.</p></li>
<li><p><strong>noise</strong> (<em>float</em><em>, </em><em>optional</em>) – Amount of noise to add to the neuron image, by default 0.05.</p></li>
<li><p><strong>dropout</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to add random signal dropout, by default True.</p></li>
<li><p><strong>adjust</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to adjust the SWC data, by default True.</p></li>
<li><p><strong>background_color</strong> (<em>optional</em>) – Background color of the neuron image, by default None.</p></li>
<li><p><strong>neuron_color</strong> (<em>optional</em>) – Color of the neuron, by default None.</p></li>
<li><p><strong>random_brightness</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply random brightness to the neuron image, by default False.</p></li>
<li><p><strong>binary</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to generate a binary image, by default False.</p></li>
<li><p><strong>rng</strong> (<em>numpy.random.Generator</em><em>, </em><em>optional</em>) – Random number generator, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>Dictionary containing the following keys:
- “image”: torch.Tensor</p>
<blockquote>
<div><p>The generated neuron image.</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>”neuron_density”: torch.Tensor</dt><dd><p>The density map of the neuron.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”section_labels”: torch.Tensor</dt><dd><p>The section labels of the neuron.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”branch_mask”: torch.Tensor</dt><dd><p>The branch mask of the neuron.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”seeds”: list</dt><dd><p>List of seed points.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”scale”: float</dt><dd><p>Scale of the neuron.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”graph”: dict</dt><dd><p>Graph representation of the neuron.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-data_prep.generate">
<span id="data-prep-generate-module"></span><h2>data_prep.generate module<a class="headerlink" href="#module-data_prep.generate" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="data_prep.generate.get_next_point">
<span class="sig-prename descclassname"><span class="pre">data_prep.generate.</span></span><span class="sig-name descname"><span class="pre">get_next_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#data_prep.generate.get_next_point" title="Link to this definition"></a></dt>
<dd><p>Generate the next point in a path using a von Mises-Fisher distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q0</strong> (<em>np.ndarray</em>) – The starting point of the previous step.</p></li>
<li><p><strong>q1</strong> (<em>np.ndarray</em>) – The ending point of the previous step.</p></li>
<li><p><strong>kappa</strong> (<em>float</em>) – The concentration parameter of the von Mises-Fisher distribution.</p></li>
<li><p><strong>step_size</strong> (<em>float</em><em>, </em><em>optional</em>) – The step size for the next point, by default 1.0.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>) – A random number generator instance, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The next point in the tractography path.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.generate.get_path">
<span class="sig-prename descclassname"><span class="pre">data_prep.generate.</span></span><span class="sig-name descname"><span class="pre">get_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uniform_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.generate.get_path" title="Link to this definition"></a></dt>
<dd><p>Get the neuron segment endpoints starting at a seed point,
and ending if the path exits the boundary or reaches the path length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>Array</em><em> or </em><em>list</em><em> of </em><em>length 3.</em>) – Path starting coordinate.</p></li>
<li><p><strong>boundary</strong> (<em>np.ndarray</em><em> of </em><em>shape</em><em> (</em><em>2</em><em>, </em><em>3</em><em>)</em>) – Image boundaries. Two vertices marking the minimum and maximum
values along each dimension.</p></li>
<li><p><strong>kappa</strong> (<em>float</em><em>, </em><em>optional</em>) – Concentration parameter for step direction distribution.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>optional</em>)</p></li>
<li><p><strong>length</strong> (<em>int</em><em>, </em><em>optional</em>) – Path length in number of segments. This is the expected path length
if uniform_len is set to False. The minimum length is 10 if uniform_len is False.
Default is 100.</p></li>
<li><p><strong>step_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Length of each path segment in pixels. Default is 1.0</p></li>
<li><p><strong>uniform_len</strong> (<em>bool</em>) – If false, the path length will be a normally distributed random number
with the expected value set by the “length” argument. Otherwise the
path length will be equal to “length”.</p></li>
<li><p><strong>random_start</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to start the path with a random direction. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>path</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (N,3)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.generate.make_swc_list">
<span class="sig-prename descclassname"><span class="pre">data_prep.generate.</span></span><span class="sig-name descname"><span class="pre">make_swc_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uniform_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_branches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#data_prep.generate.make_swc_list" title="Link to this definition"></a></dt>
<dd><p>Generate a list of SWC formatted data representing a path with optional branches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>) – The dimensions of the 3D space.</p></li>
<li><p><strong>length</strong> (<em>int</em>) – The length of the path.</p></li>
<li><p><strong>step_size</strong> (<em>float</em><em>, </em><em>optional</em>) – The step size for each move in the path, by default 1.0.</p></li>
<li><p><strong>kappa</strong> (<em>float</em><em>, </em><em>optional</em>) – The concentration parameter for the von Mises-Fisher distribution, by default 20.0.</p></li>
<li><p><strong>uniform_len</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the path length will be uniform, by default False.</p></li>
<li><p><strong>random_start</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the path will start at a random position, by default True.</p></li>
<li><p><strong>rng</strong> (<em>numpy.random.Generator</em><em>, </em><em>optional</em>) – A random number generator instance, by default None.</p></li>
<li><p><strong>num_branches</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of branches to generate, by default 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of SWC formatted data representing the generated path and branches.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.generate.save_images_from_swc">
<span class="sig-prename descclassname"><span class="pre">data_prep.generate.</span></span><span class="sig-name descname"><span class="pre">save_images_from_swc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sync</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_contrast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.generate.save_images_from_swc" title="Link to this definition"></a></dt>
<dd><p>Save images generated from SWC files to the specified output directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels_dir</strong> (<em>str</em>) – Directory containing the SWC files.</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Directory where the output images will be saved.</p></li>
<li><p><strong>sync</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only save images for SWC files that do not have corresponding output files in the output directory (default is True).</p></li>
<li><p><strong>random_contrast</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, apply random contrast to the neuron images (default is False).</p></li>
<li><p><strong>rng</strong> (<em>numpy.random.Generator</em><em>, </em><em>optional</em>) – Random number generator for reproducibility. If None, a new generator is created (default is None).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-data_prep.image">
<span id="data-prep-image-module"></span><h2>data_prep.image module<a class="headerlink" href="#module-data_prep.image" title="Link to this heading"></a></h2>
<p>Functions for setting up neuron images and ground truth data in swc format for neuron tracing.</p>
<p>Author: Bryson Gray
2024</p>
<dl class="py class">
<dt class="sig sig-object py" id="data_prep.image.Image">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">data_prep.image.</span></span><span class="sig-name descname"><span class="pre">Image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.image.Image" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Image class for tracking environment image data</p>
<dl class="py method">
<dt class="sig sig-object py" id="data_prep.image.Image.crop">
<span class="sig-name descname"><span class="pre">crop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.image.Image.crop" title="Link to this definition"></a></dt>
<dd><p>Crop an image around a center point (rounded to the nearest pixel center).
The cropped image will be smaller than the given radius if it overlaps with the image boundary unless pad is set to True.
Interpolation is not currently implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center</strong> (<em>list</em><em> or </em><em>tuple</em>) – The center of the cropped image in slice-row-col coordinates. This will be rounded to the nearest pixel index.</p></li>
<li><p><strong>radius</strong> (<em>int</em>) – The radius of the cropped image. The total width is 2*radius + 1  in each dimension assuming it doesn’t intersect with a boundary.</p></li>
<li><p><strong>interp</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, interpolation will be applied (currently not implemented). Default is False.</p></li>
<li><p><strong>padding_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – The mode to use for padding if <cite>pad</cite> is True. Default is “zeros”. Not currently implemented.</p></li>
<li><p><strong>pad</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the cropped image will be padded to the size specified by the radius. Default is True.</p></li>
<li><p><strong>value</strong> (<em>float</em><em>, </em><em>optional</em>) – The value to use for padding if <cite>pad</cite> is True. Default is 0.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>patch</strong> (<em>ndarray</em>) – Cropped image</p></li>
<li><p><strong>padding</strong> (<em>ndarray</em>) – Length that patch overlaps with image boundaries on each end of each dimension.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="data_prep.image.Image.draw_line_segment">
<span class="sig-name descname"><span class="pre">draw_line_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.image.Image.draw_line_segment" title="Link to this definition"></a></dt>
<dd><p>Add an image patch with the new line segment to the existing image in the specified channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment</strong> (<em>array_like</em>) – array with two three dimensional points (shape: 2x3)</p></li>
<li><p><strong>width</strong> (<em>scalar</em>) – segment width</p></li>
<li><p><strong>channel</strong> (<em>int</em><em>, </em><em>optional</em>) – The channel in which to draw the line segment (default is 3).</p></li>
<li><p><strong>value</strong> (<em>float</em><em>, </em><em>optional</em>) – The value to assign to the line segment (default is 1.0).</p></li>
<li><p><strong>binary</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the line segment will be added in a binary fashion (default is False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>old_patch</strong> (<em>torch.Tensor</em>) – The original patch of the image before the line segment was added.</p></li>
<li><p><strong>new_patch</strong> (<em>torch.Tensor</em>) – The new patch of the image after the line segment was added.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="data_prep.image.Image.draw_point">
<span class="sig-name descname"><span class="pre">draw_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.image.Image.draw_point" title="Link to this definition"></a></dt>
<dd><p>Draw a point on the image data with a specified radius and value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>torch.Tensor</em>) – The coordinates of the point to be drawn.</p></li>
<li><p><strong>radius</strong> (<em>float</em><em>, </em><em>optional</em>) – The radius of the point to be drawn. Default is 3.0.</p></li>
<li><p><strong>channel</strong> (<em>int</em><em>, </em><em>optional</em>) – The channel on which to draw the point. Default is -1.</p></li>
<li><p><strong>binary</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the point will be drawn as a binary value. Default is False.</p></li>
<li><p><strong>value</strong> (<em>int</em><em>, </em><em>optional</em>) – The value to assign to the point. Default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.image.draw_line_segment">
<span class="sig-prename descclassname"><span class="pre">data_prep.image.</span></span><span class="sig-name descname"><span class="pre">draw_line_segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">segment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.image.draw_line_segment" title="Link to this definition"></a></dt>
<dd><p>Generate an image of a line segment with width.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment</strong> (<em>torch.Tensor</em>) – array with two three dimensional points (shape: 2x3)</p></li>
<li><p><strong>width</strong> (<em>scalar</em>) – segment width</p></li>
<li><p><strong>binary</strong> (<em>bool</em>) – Make a line mask rather than a blurred idealized line.</p></li>
<li><p><strong>value</strong> (<em>float</em>) – If binary is set to True, set the line brightness to this value. Default is 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X</strong> – A patch with the new line segment starting at its center.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-data_prep.load">
<span id="data-prep-load-module"></span><h2>data_prep.load module<a class="headerlink" href="#module-data_prep.load" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="data_prep.load.parse_swc_list">
<span class="sig-prename descclassname"><span class="pre">data_prep.load.</span></span><span class="sig-name descname"><span class="pre">parse_swc_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swc_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.load.parse_swc_list" title="Link to this definition"></a></dt>
<dd><p>Parses a list of SWC data and constructs sections, section graph, branches, and terminals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swc_list</strong> (<em>list</em>) – A list of SWC data where each element is a list representing a node in the SWC format.</p></li>
<li><p><strong>adjust</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, scales and shifts the coordinates (default is True).</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, transposes the coordinates (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sections</strong> (<em>dict</em>) – A dictionary where keys are section IDs and values are tensors of section coordinates.</p></li>
<li><p><strong>section_graph</strong> (<em>dict</em>) – A dictionary representing the graph of sections.</p></li>
<li><p><strong>branches</strong> (<em>torch.Tensor</em>) – A tensor of branch points.</p></li>
<li><p><strong>terminals</strong> (<em>torch.Tensor</em>) – A tensor of terminal points.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – The scaling factor applied to the coordinates.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.load.swc">
<span class="sig-prename descclassname"><span class="pre">data_prep.load.</span></span><span class="sig-name descname"><span class="pre">swc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.load.swc" title="Link to this definition"></a></dt>
<dd><p>Load and parse an SWC file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>labels_file</strong> (<em>str</em>) – Path to the SWC file to be loaded.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of parsed SWC data, where each sublist contains:
[index, type, x, y, z, radius, parent_index].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function attempts to read the file with the default encoding first.
If it fails, it retries with ‘latin1’ encoding.
Lines starting with ‘#’ or empty lines are ignored.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_prep.load.tiff">
<span class="sig-prename descclassname"><span class="pre">data_prep.load.</span></span><span class="sig-name descname"><span class="pre">tiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1.0,</span> <span class="pre">1.0,</span> <span class="pre">1.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#data_prep.load.tiff" title="Link to this definition"></a></dt>
<dd><p>Load a stack of TIFF images from a directory, downsample them, and optionally invert the pixel values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_dir</strong> (<em>str</em>) – Directory containing the TIFF images.</p></li>
<li><p><strong>pixelsize</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Pixel size in each dimension (z, y, x). Default is [1.0, 1.0, 1.0].</p></li>
<li><p><strong>downsample_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – Factor by which to downsample the images. Default is 1.0.</p></li>
<li><p><strong>inverse</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, invert the pixel values. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tensor containing the processed image stack with shape (channels, height, width, depth).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-data_prep">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-data_prep" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Bryson Gray, Daniel Tward.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>