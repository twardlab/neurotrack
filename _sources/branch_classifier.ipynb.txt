{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Branch Classifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "%load_ext autoreload\n",
    "%autoreload 2\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "from datetime import datetime\n",
    "from glob import glob\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "import os\n",
    "import pandas as pd\n",
    "import sys\n",
    "import torch\n",
    "\n",
    "sys.path.append(\"../\")\n",
    "from data_prep import collect, load\n",
    "from solvers import branch_classifier\n",
    "import models\n",
    "date = datetime.now().strftime(\"%m-%d-%y\")\n",
    "dtype = torch.float32\n",
    "DEVICE = \"cuda\" if torch.cuda.is_available() else \"cpu\""
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Collect branch classifier training data\n",
    "Training data consists of volumetric image patches chosen randomly from the neuron node coordinates given\\\n",
    "in the SWC file with an added small random translation. Image patches are labeled 1 if they are centered on\\\n",
    " a branch point and 0 otherwise."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get sample points from swc files"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "loading file: /home/brysongray/data/neuromorpho_sub1/beining/CNG version/35dpi_ipsi_infra_06.CNG.swc\n",
      "loading file: /home/brysongray/data/neuromorpho_sub1/campos/CNG version/Astro-1.CNG.swc\n",
      "loading file: /home/brysongray/data/neuromorpho_sub1/allen cell types/CNG version/646805498_transformed.CNG.swc\n"
     ]
    }
   ],
   "source": [
    "# Load SWC file data into python lists\n",
    "labels_dir = \"/home/brysongray/data/neuromorpho_sub1\"\n",
    "files = [f for x in os.walk(labels_dir) for f in glob(os.path.join(x[0], '*.swc'))]\n",
    "swc_lists = []\n",
    "for f in files:\n",
    "    swc_lists.append(load.swc(f))\n",
    "\n",
    "# Collect random sample points from SWC data\n",
    "samples_per_file = 50\n",
    "fnames = [f.split('/')[-1].split('.')[0] for f in files]\n",
    "sample_points = collect.swc_random_points(samples_per_file, swc_lists, fnames, adjust=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Save sample patches and labels from image files"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "# save sample patches from the images centered at the sample points\n",
    "image_dir = \"/home/brysongray/data/simulated_neurons/neuromorpho_sub1_with_artifacts\"\n",
    "out_dir = \"classifier_data\"\n",
    "if not os.path.exists(out_dir):\n",
    "    os.makedirs(out_dir, exist_ok=True)\n",
    "name = \"neuromorpho_test\"\n",
    "\n",
    "collect.collect_data(sample_points, image_dir, out_dir, name, date)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### View some example input images"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAd4AAAGZCAYAAAAnw1AXAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIWXMAAA9hAAAPYQGoP6dpAAA+hElEQVR4nO3de5BUZZrv+9/KzKrKqsq6F1VAgSVSlIqIdntpQBEUhdEZW6UvO9h00+6J2Uc72tkT0b09f5wTDXomwhPd0bM99pxzuj17b8XwMgOHLbq37QU5A85Mz2h7pUEQLO7XKqgbBXXNyvf8QVsxRPE8WYP2Kmi/nwgiJJ9817sy813ryYXryScKIQQBAIBYJMZ7BwAA+DIh8QIAECMSLwAAMSLxAgAQIxIvAAAxIvECABAjEi8AADEi8QIAECMSLwAAMYot8a5evVpRFGnfvn3/6rGPPPKIoijSiRMnvrD9+Wybn8cHH3yg22+/XZlMRpWVlVq6dKn27Nkz5vEbN27U3LlzVVJSotraWt1///1qa2v7XPuELx5rdzTW7sWBtTvahbB2ueI9T5988okWLlyowcFBrV27Vk899ZR27dql+fPn6/jx43nHv/XWW7rzzjtVX1+vl19+WU888YQ2btyoRYsWaWBgIIZXgC8r1i4uVn8oazcV20x/YFauXKmioiK98sorKi8vlyRdd911mjFjhn72s5/pJz/5iTv+4YcfVnNzs9atW6dU6szHMG3aNN1000166qmn9P3vf//3/hrw5cTaxcXqD2XtjusV75tvvql77rlHU6ZMUTqdVlNTkx544AHznzYOHjyopUuXqry8XBUVFfrOd75zzm85a9as0dy5c1VaWqpMJqMlS5boww8//ML2O5vN6pVXXtE3vvGNkQ9fkhobG3Xrrbdq/fr17vjDhw/r3Xff1Xe/+92RD1+S5s2bp+bm5rzjMf5Yu6zdixVrd/zX7rgm3t27d2vu3Ln6xS9+oQ0bNmjlypV65513dPPNN2toaGjU8++77z41NTVp3bp1euSRR/TSSy9pyZIlZz33scce07JlyzRz5kytXbtWzz77rHp6ejR//nxt377d3Z/P/n/I6tWr8+53X1+fZs+ePSo2e/ZstbS0qL+/3xy/bdu2keeea/xncVy4WLus3YsVa3f81+64/lPzgw8+OPLfIQTNmzdPCxcuVGNjo1577TV9/etfP+v5S5cu1U9/+lNJ0uLFi1VfX6/ly5dr7dq1Wr58uQ4ePKhVq1bpoYce0s9//vORcXfccYdmzJihRx99VGvWrDH3J5FIKJlMKpHwv4+0t7dLkqqrq0fFqqurFUJQZ2enJk2adF7jP4vjwsXaZe1erFi74792x/WKt62tTQ8++KCmTp2qVCqlgoICNTY2SpJ27Ngx6vnLly8/6+/f/va3lUqltGnTJknSG2+8oWw2qxUrViibzY78SafTWrBggTZv3uzuz2fjVqxYMab99+7OG8ude9ZzPu9df/j9Y+2ydi9WrN3xX7vjdsWby+W0ePFiHTlyRD/+8Y919dVXq7S0VLlcTnPmzFFfX9+oMRMnTjzr76lUSjU1NSPfVFpbWyVJN9xwwznnzPeNaqxqamok6ZzfkDo6OhRFkSorK897/Lm+keHCwdpl7V6sWLsXxtodt8S7bds2bdmyRatXr9b3vve9kcdbWlrMMceOHVNDQ8PI37PZrNrb20fe0NraWknSunXrRr7B/T5Mnz5dxcXF2rp166jY1q1b1dTUpHQ6bY6fNWvWyHPvuuuuUeM/i+PCxNpl7V6sWLsXxtodt39q/uyyvqio6KzHn3zySXPM888/f9bf165dq2w2q4ULF0qSlixZolQqpd27d+v6668/558vQiqV0t13360XX3xRPT09I48fOHBAmzZt0tKlS93xDQ0NuvHGG/Xcc89peHh45PG3335bO3fuzDse44u1y9q9WLF2L5C1G2Ly9NNPB0lh7969IYQQBgcHw/Tp00NjY2N44YUXwuuvvx5+8IMfhObm5iAprFq1amTsqlWrgqTQ2NgYHn744bBhw4bw+OOPh0wmE6655powMDAw8tzHHnsspFKp8MADD4T169eHzZs3hzVr1oQf/ehHYeXKlaO2+S8988wzIZlMhmeeeSbv69mxY0fIZDLhlltuCa+++mp48cUXw6xZs8LkyZNDW1vbWc9NJpPhtttuO+uxTZs2hVQqFe67777w5ptvhueffz5MnTo1zJo1K/T394/1bUUMWLus3YsVa/fCXLvjlnhDCGH79u3hjjvuCGVlZaGqqip861vfCgcOHDAXwPvvvx/uvvvukMlkQllZWVi2bFlobW0dNddLL70Ubr311lBeXh6KiopCY2Nj+OY3vxk2btw4apvn2senn356TK/p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f/XYRx55RFEU6cSJz9d8+Fzb/Dw++OAD3X777cpkMqqsrNTSpUu1Z8+eMY/fuHGj5s6dq5KSEtXW1ur+++9XW1vb59onfPFYu6Oxdi8OrN3RLoS1yxXvefrkk0+0cOFCDQ4Oau3atXrqqae0a9cuzZ8/X8eP27+a9Zm33npLd955p+rr6/Xyyy/riSee0MaNG7Vo0SINDPi/DgN8HqxdXKz+UNbumH8yEmdbuXKlioqK9Morr6i8vFySdN1112nGjBn62c9+pp/85Cfu+IcffljNzc1at26dUqkzH8O0adN000036amnntL3v//93/trwJcTaxcXqz+UtTuuV7xvvvmm7rnnHk2ZMkXpdFpNTU164IEHzH/aOHjwoJYuXary8nJVVFToO9/5zjm/5axZs0Zz585VaWmpMpmMlixZog8//PAL2+9sNqtXXnlF3/jGN0Y+fElqbGzUrbfeqvXr17vjDx8+rHfffVff/e53Rz58SZo3b56am5vzjsf4Y+2ydi9WrN3xX7vjmnh3796tuXPn6he/+IU2bNiglStX6p133tHNN9+soaHRP2B93333qampSevWrdMjjzyil156SUuWLDnruY899piWLVummTNnau3atXr22WfV09Oj+fPna/v27e7+fPb/Q1avXp13v/v6+jR79uxRsdmzZ6ulpUX9TuODbdu2jTz3XOM/i+PCxdpl7V6sWLvjv3bH9Z+aH3zwwZH/DiFo3rx5WrhwoRobG/Xaa6/p61//+lnPX7p0qX76059KkhYvXqz6+notX75ca9eu1fLly3Xw4EGtWrVKDz30kH7+85+PjLvjjjs0Y8YMPfroo1qzZo25P4lEQslkUok83TDa29slSdXVo7t4VFdXK4Sgzs5OTZo06bzGfxbHhYu1y9q9WLF2x3/tjusVb1tbmx588EFNnTpVqVRKBQUFamxslCTt2LFj1POXL19+1t+//e1vK5VKadOmTZKkN954Q9lsVitWrFA2mx35k06ntWDBAm3evNndn8/GrVixYkz7792dN5Y796znfN67/vD7x9pl7V6sWLvjv3bH7Yo3l8tp8eLFOnLkiH784x/r6quvVmlpqXK5nObMmaO+vr5RYyZOnHjW31OplGpqaka+qbS2nun/ecMNN5xzznzfqMaqpqZGks75Damjo0NRFKmysvK8x5/rGxkuHKxd1u7FirV7YazdcUu827Zt05YtW7R69Wp973vfG3m8paXFHHPs2DE1NDSM/D2bzaq9vX3kDa2trZUkrVu3buQb3O/D9OnTVVxcrK1bt46Kbd26VU1NTUqn7Wbns2bNGnnuXXfdNWr8Z3FcmFi7rN2LFWv3wli74/ZPzZ9d1hcVFZ31+JNPPmmOef7558/6+9q1a5XNZrVw4UJJ0pIlS5RKpbR7925df/315/zzRUilUrr77rv14osvqqenZ+TxAwcOaNOmTVq6dKk7vqGhQTfeeKOee+45DQ8Pjzz+9ttva+fOnXnHY3yxdlm7FyvW7gWydkNMnn766SAp7N27N4QQwuDgYJg+fXpobGwML7zwQnj99dfDD37wg9Dc3BwkhVWrVo2MXbVqVZAUGhsbw8MPPxw2bNgQHn/88ZDJZMI111wTBgYGRp772GOPhVQqFR544IGwfv36sHnz5rBmzZrwox/9KKxcuXLUNv+lZ555JiSTyfDMM8/kfT07duwImUwm3HLLLeHVV18NL774Ypg1a1aYPHlyaGtrO+u5yWQy3HbbbWc9tmnTppBKpcJ9990X3nzzzfD888+HqVOnhlmzZoX+/v6xvq2IAWuXtXuxYu1emGt33BJvCCFs37493HHHHaGsrCxUVVWFb33rW+HAgQPmAnj//ffD3XffHTKZTCgrKwvLli0Lra2to+Z66aWXwq233hrKy8tDUVFRaGxsDN/85jfDxo0bR23zXPv49NNPj+k1vffee2HRokWhpKQklJeXh3vvvTe0tLSMep6ksGDBglGPb9iwIcyZMyek0+lQXV0dVqxYcc7Xg/HF2l0w6nHW7sWBtbtg1OMXwtqlOxEAADHit5oBAIgRiRcAgBiReAEAiBGJFwCAGJF4AQCIEYkXAIAYjfknI++c+hdmbHiS/xuX++4uN2ML7rT7Nf7V5E1m7P69f+LOuePVZjM26W27dVTRrmNmLAyObpl1Vrxhgh372P5JtuTUyfa4073unMpmzdDrx+1fo/kyWVJ2vxmL0kVmTJJUVWGGQuu5+5dK0sk/mmnG2m7wv+9+Zd4uMza/yl5H//nTeWYs9UalO2fduz1mLHm82x7oHBOhtNidM1dZasY2/GaVO/bL4qZv/syMteZZR9nSnBkLpcNmLNllp4WGzfY2JSnzcZs9Zyppxoar7bWQanXWn6RQYO9vdJ7rMzrln3dDr51DXm/9v92xEle8AADEisQLAECMSLwAAMSIxAsAQIxIvAAAxIjECwBAjMZcThQqy8xYouu0O7bwpF1OtK+nxoz9z0cXmrH76uwyJEnqXFRixvpaJpmxon0FZiwqtGOSNPzbnWYsWZ4xY7lj9i34UZk97sw+FbpxSIlye+1661qS1NZub3eCvXbLf7XVjPXWX+tO+W71NDP20G3/nxm7v8ku1/jr1kXunAWn7feh5n2nJGPfITOWyFOqlWg56MYhFXbZ5YKFXXlK4ab1maG6ylNmrK3EXgvtM+2yH0kqarfL71KddolOlHXKlLJ26dOZDdvrPldpnz8Hau1youLddrmQlD8X5MMVLwAAMSLxAgAQIxIvAAAxIvECABAjEi8AADEi8QIAECMSLwAAMRpzHW/Ubdd9hYFBd2zFHrsO68TaqWbs+B/bNWMnh9LunP1Z+6Ud/6r9faPkaJUZS53yX2cyY+9vlHHqeCfac0YH7RpfScq2HnfjkFTk1DrnqRGMip3WdkN2jWU0ud6MVe3y11HfBHt/f3n0VjP2zKUbzdjzk6935wyRXZMcosiOXWnXHOd27nfnjNL+MQwp7bQpLZpxiTt2YL99Pjrca6+x2rqTZqxzQp5Wj0V2TW0odNr3OXW8odivVx6utH+zIXXYrsMvbu2w53R+d0GSov4BN54PV7wAAMSIxAsAQIxIvAAAxIjECwBAjEi8AADEiMQLAECMxt4W0CkZikr8soDyLa1mLHedXXZxos++jbw367dl+uFldmnFw7uWmbHDC+1b0+s+8OcsbbXHKgQzlNh7xIxFTomSJKUutcux8DteyVCPXSYnScOn7JaXCa98rMBuhVn8qV8C1njSbq324fCVZuzqWVPMWHmp3+bs1BS7ZKjskP06i445759TUiXJbbmIM0K5/d6XHbLL2SSpsMcu7Wn9mn3qH/i41oylKuzzmCT1TLXP2RUD9nHotQzM1vqlPal2py2t0zIw9NrtLqNT9v5IkmgLCADAxYPECwBAjEi8AADEiMQLAECMSLwAAMSIxAsAQIzGXE6kAbsbQ0jYpQiSFDndTTL77du22z8pM2OpBrubhST9PwdvMWPXXrvH3m7C3u7OnsvdOUu3jv3tHKtQkGeblGTk55RyeR2GpDwlQ4V2h5ec1zWqye8qo5y9v9NeOGrGTl5bZ8Zar/dLMnI19rofqLLXYEG3XVaR2G93f5GkyOsaBUlS/2T7HFjyqf/+Ji6pNGOFXXbZT991TmlPt/+Zhd12+U7vZLvsNNNnH4cFe+1yVEnK1Tnd3bp77JhTEpSrsssBJSlb+fk6a3HFCwBAjEi8AADEiMQLAECMSLwAAMSIxAsAQIxIvAAAxGjs9S91NWYoHPFv91bDRDOULbNvT69/z77FfFe7X9pTsPiEGVt/+YtmrCiy35Krbprsztmzz46XfWSXgcgpt8qVOR2PJCVO+CUFkJRzSs+mTnKHRiftzifB+Wy8b7S5PYfcOZNJe3SUtssYyjfsMGP9VVe5cw4X2XMm++3jMHnUXn/5ygxDnpINSOkjdjlMyNMhJ1fgrMIr7e1eVd9mxo5X+93Sug7Y5/rKzXaHrGSnvT9K+Wkq0WV3yArlThmdV6qZ9Ndu4V77PRoLrngBAIgRiRcAgBiReAEAiBGJFwCAGJF4AQCIEYkXAIAYkXgBAIjR2Ot427vMUJSnzio6ZbeZSv3dXjOWntZobzM7wZ3z4GXVZix3rV3XmYzs7yKXTfBb8B2ccakZK+y29zfVbbdcTLZ1unOqssKPQ6G02IxFvXZtoSSFvj57bNaubw3ZYTOWKLdbvUlSqLBrD8OhY/b+lNiv8+R0d0qFhN2KsOCU3eqttNhuL5crs9u1SVJiYMjfKSgU2ufWbIX93ktSf439uRUV2mv3rrqtZmx7r/9bBq/U2q0pT06312emyNnXT+01L0mhxP+tA9Mxu3Wn1w5UkkKvfV4YC654AQCIEYkXAIAYkXgBAIgRiRcAgBiReAEAiBGJFwCAGI25nCjXa5cE5bv1ethrXRfsMoaQtlsGFnYPunMqZ9+6ftN7/86MzaixbzHf/Wu7vEmSBq+w92nQufW/5mP7dVb2+68z7D/sxiFFfXa5lhL+d8+oyP7cwoC9Xa/EzhsnSTpityIcvK7JjLX+B7s0asX0Te6U6/fPNmM9p2vNWO2v7fZpSaddmyTJKbnCGdGQ8x4N2+dOSUo41VoDW+xSr421V5qxdNIvAUtOsfNEa5l9LA29Z8cm7nTaeuYR9dvHWnBa3co7Z0gamn3pee7RGVzxAgAQIxIvAAAxIvECABAjEi8AADEi8QIAECMSLwAAMRpzOVHCKatQZJcUSFKiscEeOmR3yRj+dJ8zzi+zqWucY8bK/pv9WvZcPcOMDV5n76skPbnwGTP2Uud1Zuy1KVeZsaFiu5RDkurydNeBFMrtcje31EhSyNhlaaGg3IwN//YTM5Zs9lsFRU6Zzd4/tUtIttzwlBnLJNLunNt67K4zB3fYnb68cqzsBL/MMNXa5caRp7Nbyr9uKj1in5dPXmqv622vXW7G/mzZ6+6cS7/6gRl7ofVrZmzrEXvOXJ3f5corSVXSfo+i006HoWG/hKlwv9+pLh+ueAEAiBGJFwCAGJF4AQCIEYkXAIAYkXgBAIgRiRcAgBiNuZxIyaQZ8jqxSFLosbutDHd0mTGv61FUOsGds2rDLjtYY9+eXr6/wIwN3GHf2i9JOwfskow/n/B3ZmzKdZ1m7L923erOWWdvFr8T9dif2/Akp1RGUrKty4wFZ+26JUPOOElSsV3qkRuwj0OvZOiXXXZJnyR9+oxdzlH/wTF7fw4eMWOpOv8Y1ZDf6QbyOzi1HHCHFlZVmrEp/fa6P3pzmRk7MZRx5/xh9R4zdvmU/2HG7qqzj5e2r1W6c9a9bZ8/h2rsHFLY7XTPKrI7xkmShj9fZy2ueAEAiBGJFwCAGJF4AQCIEYkXAIAYkXgBAIgRiRcAgBiReAEAiNGY63gjp6Z2+FibOzZZZ7e2SzRPsweesOuzwsked87gtYoqsdsCJgftdlDZ7XYbOEkautyusfS80HK9GSvb63836pzj12dCUoG9zBP77BpVSVLKqV8vsettI6ddY/aE31IsuuFqM7b8+nfM2G8G7LrYv/roDnfOGZta7f1x2qd57UJDkV0TL0lK56mVhEKx/f4mcna9reTXqCePdpixql12PfjfbrnBnbPgK3Z9a3/OXg/JCnvtZkvy/E5EoR0vbDlqxoYbnLy0+7A7Z+4y+zcbxoIrXgAAYkTiBQAgRiReAABiROIFACBGJF4AAGJE4gUAIEZjLifKVdjtoBK9frs8r8VSrmWfvd3KCntcn12ukW9s2H3QjGWnXmnGUr2RO+f/udku2fhl7c1mrGKDXapVcjzrzln6DzvdOCR5pWVDg+7Q4UsvMWOJPXbJgTOjEmV+GUjbV+xjbc3268zY8yfnmrEpG/y1G/Xb70MYdN4jp12o2rv8OSv98jxIStjXRrl6v6Vlostux5qrtNdgqtcuCardZJc3SdJzHfPNWMNVdsna7KmHzNjHe5rcOXunlJixshNOyVrkHBNJ/5o0+ni3G8+HK14AAGJE4gUAIEYkXgAAYkTiBQAgRiReAABiROIFACBGYy4nGi6zbyNPHfBLXjzJCXaHiFBm3yaeLMjT+aTQidfZt+EH56tINuMViUiJ6gE7tssuGSrusG/fT7fanWEkSbV+SQGk4HTXUco/BJJtXWZs+OQpM5aYNtWMZa/wO0r1OA27rp5ilzBtO2x3TBnM2MeSJIUeu9tXGHKO72F77UbTG9051eV3GIMv0W2XC0lSrvW4GYsm15uxok+6zFhhjf+ZVuyyT6AHSyaYsR8uetOMbbvHLv+UpL/7B7tUM3TbayzplBkOT53ozpk8esKN58MVLwAAMSLxAgAQIxIvAAAxIvECABAjEi8AADEi8QIAEKMxlxOlduwzY0OzL3PHFh5st4MF9i6E/U73F68riqTQb5f2RFfZ3S4yH9u34LfPnOTOWfzPdslGYY9963rxEbvcJbn3mDunVwaC33E6a6mz+7w3m2xwSg4G7I4+PVP9Di9DE4bM2PKJ75ix47V2x5kndtzjzlmbcd6jk/Yay2XtUqNEt11uJUk5Z7v4He/82N7pDk3UOKWGwzl7u+X2Wij/qM2dc2iefUzUX9JhxiYm7eOwv8gvHV292H6PLm+xu9QNV9klnol9R905Q54yxHy44gUAIEYkXgAAYkTiBQAgRiReAABiROIFACBGJF4AAGJE4gUAIEZjL0Zy6mYLOnrdoaH7pB2ss9sCRsVpO1aSp82ZN+c+uz44cuoZG//zTnfO3hvseuZ0m/0eJXr67Y0Gu95OkqLiYjcOKVtXbsbyHQAhis5v0pR9vFR+7Nev9lfZtYebrrnSjM0tbzFjyWv9euXjt19ixmr/2Wkvd8iudwzFfr1yIlnpxiEpZx//A9c4/SMlFX3stNMrrzJD0Um73eDgZXZrP0kqPWLXr5/+W3vsn927woz1nrTzgCQ1XmOvwaNL7FaZdW/bOWK43a45lqSkVyM9BlzxAgAQIxIvAAAxIvECABAjEi8AADEi8QIAECMSLwAAMYpCCHa/OgAA8IXiihcAgBiReAEAiBGJFwCAGJF4AQCIEYkXAIAYkXgBAIgRiRcAgBiReAEAiBGJFwCAGP3/jcvC28NJbkYAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 9 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "observations = os.listdir(os.path.join(out_dir, \"observations\"))\n",
    "training_annotations = pd.read_csv(glob(os.path.join(out_dir, \"*_labels.csv\"))[0])\n",
    "ids = np.random.choice(len(training_annotations), size=9)\n",
    "sample = training_annotations.iloc[ids]\n",
    "\n",
    "fig, ax = plt.subplots(3,3)\n",
    "ax = ax.flatten()\n",
    "for i in range(len(ax)):\n",
    "    img = torch.load(os.path.join(out_dir,\"observations\", sample.iloc[i,0]), weights_only=True) # type: ignore\n",
    "    ax[i].imshow(img[0].amax(0))\n",
    "    ax[i].set_title(f\"label: {sample.iloc[i,1].item()}\")\n",
    "    ax[i].set_axis_off()\n",
    "\n",
    "    "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Train branch classifier"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Instantiate dataloader for training and test datasets\n",
    "Dataloaders use a weighted random sampler to balance classes. Additionally, the training dataset\\\n",
    " adds a random permutation and flip to the image patch at retrieval."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "# set source data files paths\n",
    "training_labels_file = \"classifier_data/branch_classifier_neuromorpho_test_02-07-25_test_labels.csv\"\n",
    "test_labels_file = \"classifier_data/branch_classifier_neuromorpho_test_02-07-25_training_labels.csv\"\n",
    "img_dir = \"classifier_data/observations\"\n",
    "\n",
    "# instantiate training and test datasets\n",
    "transform = branch_classifier.transform # random permutation and flip\n",
    "training_data = branch_classifier.StateData(labels_file=training_labels_file,\n",
    "                          img_dir=img_dir,\n",
    "                          transform=transform)\n",
    "test_data = branch_classifier.StateData(labels_file=test_labels_file,\n",
    "                          img_dir=img_dir)\n",
    "\n",
    "# instantiate dataloaders\n",
    "training_dataloader = branch_classifier.init_dataloader(training_data)\n",
    "test_dataloader = branch_classifier.init_dataloader(test_data)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## View balanced data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAd4AAAGZCAYAAAAnw1AXAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIWXMAAA9hAAAPYQGoP6dpAABAnUlEQVR4nO3de3SUZbom/OutYw6VAzmTBJKQcIZsPIAtzmxUmq24GXtkUIe99lLRvZsWHPT7lJnZ7SGCaDvf12vbS2cYD2MjIwIubTw24gFpdvc0bUPbvZugtERJCIScKgk5VipV9cwfaWkj3HeVHJ4kcv3WYi3Nned931SeqjsF75XbMcYYEBERkRWu4b4AIiKiCwkbLxERkUVsvERERBax8RIREVnExktERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERk0XlvvC+88AIcx8G+ffvOyfEcx8Fdd911To711WM+/PDDZ7z+gQcewKJFi1BUVATHcXDbbbd9o/Xd3d245557UFhYiKSkJMyaNQtbt2494+uhc4N7Nz7u3ZHpQti7AwMDWLNmDUpLS+H3+zFlyhQ89dRTCa8fzr3Ld7znwBNPPIFgMIjrr78ePp/vG69fvHgxNm7ciKqqKrzzzjuYPXs2li5dis2bN5+HqyX6C+5dGq1WrFiBH/3oR1i5ciXeffdd3HDDDbj77rvx2GOPJbR+OPeu57yf4QLQ1dUFl2vwZ5gXX3zxG63dvn073n//fWzevBlLly4FAFx11VWoq6vD6tWrcfPNN8Ptdp/zayYCuHdpdDpw4ACef/55PProo1i9ejUA4Morr0QwGMS6devwgx/8AFlZWeL64d67I+IdbygUwr333otZs2YhIyMDWVlZuPzyy/HGG2+Ia5555hlMmjQJfr8f06ZNO+1fETQ2NmL58uUoLi6Gz+dDWVkZ1qxZg0gkck6v/8sXrjPx2muvIRAI4MYbbxzy8WXLlqGhoQEfffTR2V4enUfcu9y7o9Vo3ruvv/46jDFYtmzZkI8vW7YMfX192LFjh7p+uPfuiHjH29/fj7a2Ntx3330oKipCOBzGBx98gMWLF2PDhg245ZZbhnz+m2++iV27dmHt2rVITU3F+vXrsXTpUng8HixZsgTA4Dd/zpw5cLlceOihh1BeXo49e/Zg3bp1qK2txYYNG9RrKi0tBQDU1taejy/5pOrqakydOhUez9BvRWVl5cn63Llzz+s10Jnj3uXeHa1G896trq5Gbm4uCgoKhnz8q3sv3vph3bvmPNuwYYMBYPbu3ZvwmkgkYgYGBswdd9xhLrrooiE1ACY5Odk0NjYO+fwpU6aYioqKkx9bvny5CQQCpq6ubsj6H//4xwaAOXDgwJBjVlVVDfm88vJyU15envA1fyk1NdXceuutCX/+xIkTzTXXXHPKxxsaGgwA89hjj33ja6Bzg3tXx707cn3b9+6CBQvM5MmTT1vz+Xzm+9//vrp+uPfuiPirZgB45ZVXcMUVVyAQCMDj8cDr9eL555/Hp59+esrnzp8/H/n5+Sf/3+124+abb0ZNTQ2OHj0KAHj77bdx1VVXobCwEJFI5OSfhQsXAgB2796tXk9NTQ1qamrO4VcocxznjGo0MnDvfvMajQyjee+e7d4bzr07Ihrvtm3bcNNNN6GoqAibNm3Cnj17sHfvXtx+++0IhUKnfP7X/3rhqx8LBoMAgKamJrz11lvwer1D/kyfPh0A0Nraeh6/osRlZ2efvOavamtrAwD1BgEafty73Luj1Wjeu9Le6+npQTgcjrv3hnvvjoh/4920aRPKysrw8ssvD/lJo7+//7Sf39jYKH4sOzsbAJCTk4PKyko8+uijpz1GYWHh2V72OTFz5kxs2bIFkUhkyL837N+/HwAwY8aM4bo0SgD3LvfuaDWa9+7MmTOxdetWNDY2DvmBING9N9x7d0S843UcBz6fb8g3v7GxUby7bufOnWhqajr5/9FoFC+//DLKy8tRXFwMAFi0aBGqq6tRXl6OSy+99JQ/I+XF64YbbkB3dzd+9rOfDfn4xo0bUVhYiMsuu2yYrowSwb3LvTtajea9+73vfQ+O42Djxo1DPv7CCy8gOTkZ1157rbp+uPeutXe8H3744WnvVLvuuuuwaNEibNu2DStWrMCSJUtQX1+PRx55BGPHjsWhQ4dOWZOTk4Orr74aDz744Mm76w4ePDjk1va1a9fi/fffx9y5c7Fq1SpMnjwZoVAItbW12L59O55++umTm+V0KioqACChf2/YvXs3WlpaAAxuxrq6Orz66qsAgHnz5iE3N/fkNa1duxY7d+7EvHnzAAALFy7EggULcOedd6KzsxMVFRXYsmULduzYgU2bNjEHOQJw73Lvjlbf1r07ffp03HHHHaiqqoLb7cbs2bPx3nvv4dlnn8W6deuG/FXxiNy75/XWLfOXu+ukP4cPHzbGGPP444+b0tJS4/f7zdSpU81zzz1nqqqqzNcvEYBZuXKlWb9+vSkvLzder9dMmTLFvPTSS6ecu6WlxaxatcqUlZUZr9drsrKyzCWXXGLuv/9+093dPeSYX7+7rqSkxJSUlCT0Nc6bN0/8+nbt2nXy8778er76MWOM6erqMqtWrTIFBQXG5/OZyspKs2XLloTOTecP9+6uk5/HvTu6XAh7NxwOm6qqKjN+/Hjj8/nMpEmTzJNPPnnK543EvesYY8x56ehERER0ihHxb7xEREQXCjZeIiIii9h4iYiILGLjJSIisoiNl4iIyCI2XiIiIosS/gUaCyfcKxf7w+paE5brTnKyvNDnlY/Z06ues/fSErF25KaoWCsuaBdrje1p6jmdQ6liLX+ffM60jxvkgw4MqOeE3yeW3jn8z/raC0TZ5sfEWlFuh7q2+URArJnP5Fp2tZzSy/xds3pOp6tHrYvXo807PZtZqDH5a3FSU5Trkfc8ADgpSWKNe3fQtdnfP+O1pihfrLmCHfK60Ol/ZWRiJ42JJSdrjLxM2/Nx9q7WX2J9p/7O6S+5szLFmpMk700AMH19Ym1HyzPqWoDveImIiKxi4yUiIrKIjZeIiMgiNl4iIiKL2HiJiIgsYuMlIiKyKOE4UawlKNYcr34Y7dbsWKt8XFd+rnzQOLeYOxElAtEmR3DSS+TbzwvHnVDP+fHhyWLN1ylfr3b7vuOJMxcyTpSLAP9BObKWXtyori0skr/nHTnycf9UOFasxTx56jmz3vxErDnZciQDXd1yzaM/R2MlBWLNVXtcrKl7NyDH6wDAxHndIMD0K49vihLFBOC0tIm1SJMcaXOlybHJWJwYpxbRQViORppe+bhqHwBglN7kycuR1ymD+bS4EAAY5WtJBN/xEhERWcTGS0REZBEbLxERkUVsvERERBax8RIREVnExktERGQRGy8REZFFCQfpXGnKeLSAPBoMAGJNrfJxs7PkhWeRlUo6JmcavZ3yOV2OnO0KR/VMbWSsnKkdCMgPtS9Pvp5oTa16Tu37QoPKNstjF5uPlqprm2+U925xWodY86bIeyFYKY+7BIDAsQqx5q9V8vTaiL5OJeMLwNUl59cRlcf7OUrmM+4oQmWcGw3SRt6pr53QM9buiRPEmtMnr3NlpOvnTJez2+FcueY9rozh69EztVqeOaZk2x238nru96vnRFR5viSA73iJiIgsYuMlIiKyiI2XiIjIIjZeIiIii9h4iYiILGLjJSIisijxuVzJ8u3e2u3nABCbNF6smS/kqEd0YrFYc/XrUYVQgXzr+kBGTKz5XPJxJwXkUVoA8EevfL0wyq3rMfl63IXyuDZKUK8cR/B3yo89ADT/Xh4r9t2//ZNYcxXJsbTPkvQxZ61H5dF/+X0ZYs3d1iMfNFePnkAZIWfGyyMOnU55nJvp0+OAsXHc2/E4Sqwl1iJH3QDA8cnjTwElBuaT424nLspXz3miXH6d83bJz4mMZLkVJR3tUs/pKKNRTVDe1+rYynhROMfR63HwHS8REZFFbLxEREQWsfESERFZxMZLRERkERsvERGRRWy8REREFiUcJzJKJEO/bR1wPjsi19Ll29rdh47KB82RIxcA0HyxXHflyRGIhTnVYm2KX44+AcDPU6eLtb5sOY6VckS+Bd+45ckbAAAPf3aKR5uelf7rWnWtp1eOwm0pnCPWNl35rFirzdPjRA91Xy/WkoLy1zKmV45VOE1yrAIAnCRlGkutvO+NEj1Bpj7JxtWtT50hwEmRv9+O9tgDgFd+eY/55dfs9spMsdZ0jT5R6sbKj/RrErz1+QyxlvuCvo9SajvFmru4UKwZZepRtFWParmz9P4TD1+1iYiILGLjJSIisoiNl4iIyCI2XiIiIovYeImIiCxi4yUiIrIo4TiRo0xjiDclwzUmU17bKU+ecMbmibXeCn3aSn+WPAnj2omfirXZybVi7bUTF6vn7DwuR6PGt0XFWixFvrXf03RCPSdC+mQoAtAhxw1MVJ9O5G+VIwe+Y/L3uyMmx0Bm+o+p51xWuUes/TR4pVhLbg2INTnM9mdK3ChWPk6suVuV/RnnsY3k6jERAuCSX3e1iCcADFSWirW6a+Ud4a7oFmtjkvTXm/+W/wexdjQiH/dYX6ZY+7RwqnrO1EPyJCHTIe9PE5anZ3lK5RghAJhgu1qPh+94iYiILGLjJSIisoiNl4iIyCI2XiIiIovYeImIiCxi4yUiIrKIjZeIiMiixMcCGjkXC5fev02PPIbPlaFk+QbkfFZHuT4Sy4yVM25LsvaKtZZoqlh7u14eXQUA6Qflh7NTiYU5EXkkm6dRedwpIY5ffnxNT4+6diBdXpvSJGcsf3z4GrFWNeEt9ZyXpx4SaxtzvyPWTkyQR0h2FetjzPJebxZrjvLc7/4reexacqP8vAeA5kvlHDQNUsexFubri5UY9cAY+fcKLJ30sVi7JOWwesrDA3JWdwDy86WmI0esRVLldQAQLpR7iM8t96bYp/LzzImTkYZbHuWaCL7jJSIisoiNl4iIyCI2XiIiIovYeImIiCxi4yUiIrKIjZeIiMiihONE6AuJJVeWHlWIZSmxgZA8mimaJUd7XANnHrN5vUMe79cckq81WKd/nWZmWKw5PfJDHTgu//wTLtbHH7p+9Qe1Tvr4r3iSDjWJtUBmkVir/VyOejwQ/ffqOS/OqRdrRTkdYq1+ojzqLVCv/4wdnVgs1oLT5edhxzT5eRjzy+sAwPjP/PtywSiR95jTo0deYj75e+5rkeMwAzG5Nssvx84A4Jd9JWLt3bbpYq25OUOsjenRX+s9nfKowphfjp26c+QIE2Jx+osSU0oE3/ESERFZxMZLRERkERsvERGRRWy8REREFrHxEhERWcTGS0REZFHCcSInNUUuRuVJFwDgROQxGdot8S6ffCt4zBtQz5mULEd7dtVPFGtlY9rE2o1zP1LP6VbGgbxdJ99K3z5RjimV/L5dPafJlG/Dp3PAJU9GSf/4uFgrb5ejCs0XF6in3F6YJ9aMMhQldcIJsdYbyVTP+dmtchTJlyVPcPqbCZ+JtTSPHEGkBB2Wo2VI16c7ufvk6W7ebnnq1tY/XirWdoyZqp6zo01+XU6tls+Z2yTHd9KP6PvI1alMcFIm3EVaW+VjKhPNAMBE5OMmgu94iYiILGLjJSIisoiNl4iIyCI2XiIiIovYeImIiCxi4yUiIrIo8elERr7d2yg1AECLEolJTRZLXZPlqMyJ6frt3KlyCgTfKawVa88U7xFrO3r1W8z/1/F/K9a6j6SLtTTlbnmTIsc8Bg/s0+uEaEuLWHPn5qprTWe3WHOS5P3gq5f3fHGTHJMDgOCl2WKt+TtydC/UJ++FSECP/F150adibcP4X6prJfGeL/d/+j25+FdndMpvHSdFjnFGW+XoIwB4/fJ+GPeuPBkqtkvOrLVepE9Ly+uWe0HWH4LyQq2HxOsvHV1iKdYjR+E8RYXyKUNxIkxJcV6X4+A7XiIiIovYeImIiCxi4yUiIrKIjZeIiMgiNl4iIiKL2HiJiIgsYuMlIiKyKOEcr4kqo/2U8X2AnkWNjEkVa+6wnN9K+0y/9L50+ZoyvfIYqTuO/Buxtj84Vj1n+wF5FFzWIXld4JicqTNHGtRzujLkfDANcrxyntFJk/cfAJgTnXKtT95HCChjNOPkEscckM/pROVRcO3T5HM6GfLzFwByfHJeWXtO9EXl51lNh/x8AIDOT+S8Mv5WXXrhUMbPmQF59CkAmG45w4pmeSSeJ0seU5p/QtnzAJyw/FoGpRbrkEdaanl5AOpY2lhvr1hzaWMVta8DQKzv7EZe8h0vERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUVsvERERBYlPhYwSx7RF2toUpe6XHJ/N275lu6+bHk8VdcM/VZ6V0yeC/jK/ovl6+mVH5Lko/rDNf7X/fJxlR9xkhqUsVZh/evUbqWnQa7SYrFmlJFiAGCUWIGTL8dl1FhFb5yRY468d93KYQcCckzJydT30c/2XyQXu+XIkC8ob2xfhzKbE0DFB8pYu9Xq0guGFllzZ+sj+rRIjJOqxOi0uNvxZv2caQGxFAvK329nnDKir16PVMIr70/HL0eRokF5dKcroMcMHbfcmxLBd7xEREQWsfESERFZxMZLRERkERsvERGRRWy8REREFrHxEhERWZR4nKhVvhXclaPf1h7Jl6NIXWXJYq1tpnxbe2a2PE0FABxHuSV+u3y9geNyPCf5uB49cdcpsSplyoiTJE9vQkyfZBMuL1DrBETy5AlOrtqjZ35gJUbn5MqTd6IF8vQXAHA3BMVaf5p8XE+ePIklkKpHmDqOZIq1zGr55/O0o8rzpUmfZONq15/DBLjG5svFOBN0TFSeThTrlCdgqVEalx4RixyXnxPudCVqdOSYfNA4r4FuZcKdyZJjSmhskWtj5J4FACZOhDYevuMlIiKyiI2XiIjIIjZeIiIii9h4iYiILGLjJSIisoiNl4iIyKKE40ROshz7iWXEmeTQL0cO+nKUyUV5chxhYrZyKziA3/96kljL7pZvTw98Jk+scOJMlTEZ8qQlJyI/BqZHjoG4UuXHHQDch+NMCyF4/lQv1pyiOHGsfnmqT6xTiZcp329Xpx6ziWVnijW3MmRoICQ/nSvGtarn3NcuP4dTWpXpL1H5ueRu7lDPGWvRr4mA6NHjcjFOtMfxyPvBpUztiXXLMSR3VpwonPJ8Mkp0z50rT/pSpyUBiDbJr4EuZbpbrFOOs7kz5AgiADjp8mt9IviOl4iIyCI2XiIiIovYeImIiCxi4yUiIrKIjZeIiMgiNl4iIiKL2HiJiIgsSjjHa1Lk0XVOvz6eqn+cMhawNCbWrpx4SKz9qm6Cek6XcklaFtLplDNsiMrZTACAlrntkbOb0RJ59JenQR7HCABw82eneGJdcl7PpYxrBAB4ffJaLcvnccu1OLlEV5y8uCgq5zrTPP3q0tR0+ZzhgJz5DNTJGXS49L3pys9V6wS4lcfI9Ol5cKONDVQywK40eXyfGdBf69GgZGrHZMrHVX6XgeOXn4ODx1WyxQPKi72Rew9iSg2A6dUf+3j4qk1ERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERkERsvERGRRY4xcbINREREdM7wHS8REZFF573xvvDCC3AcB/v27Tsnx3McB3fdddc5OdZXj/nwww+f8fqBgQGsWbMGpaWl8Pv9mDJlCp566qmE13d3d+Oee+5BYWEhkpKSMGvWLGzduvWMr4fODe7d+Lh3R6YLYe8+8MADWLRoEYqKiuA4Dm677bZvtH44927Cv7mKZCtWrMCLL76IRx55BLNnz8a7776Lu+++G11dXfjhD38Yd/3ixYuxd+9ePP7445g0aRI2b96MpUuXIhaL4e/+7u8sfAV0oeLepdHqiSeeQGVlJa6//nr89Kc//cbrh3XvmvNsw4YNBoDZu3fvOTkeALNy5cpzcqyvHrOqquqM1lZXVxvHccxjjz025OP/+I//aJKTk00wGFTX//znPzcAzObNm4d8fMGCBaawsNBEIpEzui46e9y73Luj1bd97xpjTDQaPfnfqamp5tZbb0147XDv3RHxb7yhUAj33nsvZs2ahYyMDGRlZeHyyy/HG2+8Ia555plnMGnSJPj9fkybNu20f0XQ2NiI5cuXo7i4GD6fD2VlZVizZg0i8X4/7zfw+uuvwxiDZcuWDfn4smXL0NfXhx07dqjrX3vtNQQCAdx4442nrG9oaMBHH310zq6Vzj3uXe7d0Wo0710AcMX5XeCa4d67I+Kvmvv7+9HW1ob77rsPRUVFCIfD+OCDD7B48WJs2LABt9xyy5DPf/PNN7Fr1y6sXbsWqampWL9+PZYuXQqPx4MlS5YAGPzmz5kzBy6XCw899BDKy8uxZ88erFu3DrW1tdiwYYN6TaWlpQCA2tpa9fOqq6uRm5uLgoKCIR+vrKw8WY+3furUqfB4hn4rvrp+7ty56jFo+HDvcu+OVqN5756t4d67I6LxZmRkDPmGRKNRzJ8/H+3t7fjJT35yygZobW3F3r17kZ8/ONXnuuuuw4wZM/BP//RPJzfAww8/jPb2dhw4cADjx48HAMyfPx/Jycm47777sHr1akybNk28pq9/QyTBYBBZWVmnfDw1NRU+nw/BYDDu+gkTTp209OUx462n4cW9y707Wo3mvXu2hnvvjoi/agaAV155BVdccQUCgQA8Hg+8Xi+ef/55fPrpp6d87vz5809+8wHA7Xbj5ptvRk1NDY4ePQoAePvtt3HVVVehsLAQkUjk5J+FCxcCAHbv3q1eT01NDWpqahK6dseRR2xptXO1noYX9+6Zr6fhNZr37tkazr07Ihrvtm3bcNNNN6GoqAibNm3Cnj17sHfvXtx+++0IhU6dE/r1vxr76se+/EmlqakJb731Frxe75A/06dPBzD409u5kJ2dfdqfjnp6ehAOh0/7jiKR9W1tg3N4462n4cW9y707Wo3mvXu2hnvvjoi/at60aRPKysrw8ssvD/lJo7//9MO7GxsbxY9lZ2cDAHJyclBZWYlHH330tMcoLCw828sGAMycORNbt25FY2PjkI25f/9+AMCMGTPirt+yZQsikciQv2ZJdD0NL+5d7t3RajTv3bM17Hv3vN4zbRK7rX3x4sVm8uTJQz52/PhxEwgEzNcvEYBJTk42jY2NJz8WiUTMlClTTHl5+cmP/cM//IMpLCw0bW1tca8R5yCS8fjjjw/5+PLlyxOKZGzfvt0AMFu3bh3y8WuvvZaRjGHGvcu9O1p92/fu133TONFw711r73g//PDD096pdt1112HRokXYtm0bVqxYgSVLlqC+vh6PPPIIxo4di0OHDp2yJicnB1dffTUefPDBk3fXHTx4cMit7WvXrsX777+PuXPnYtWqVZg8eTJCoRBqa2uxfft2PP300yguLhavt6KiAgDi/nvD9OnTcccdd6CqqgputxuzZ8/Ge++9h2effRbr1q0b8lcWa9euxdq1a7Fz507MmzcPALBw4UIsWLAAd955Jzo7O1FRUYEtW7Zgx44d2LRpE9xut3p+Ov+4d7l3R6tv694FBv+9uKWlBcDgjWF1dXV49dVXAQDz5s1Dbm7uyWsacXv3vLZ185efvKQ/hw8fNsYY8/jjj5vS0lLj9/vN1KlTzXPPPWeqqqpO+5PXypUrzfr16015ebnxer1mypQp5qWXXjrl3C0tLWbVqlWmrKzMeL1ek5WVZS655BJz//33m+7u7iHH/PpPXiUlJaakpCShrzEcDpuqqiozfvx44/P5zKRJk8yTTz55yud9+fXs2rVryMe7urrMqlWrTEFBgfH5fKaystJs2bIloXPT+cO9+xfcu6PLhbB3582bJ359X92nI3HvcjoRERGRRSPirmYiIqILBRsvERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUVsvERERBYl/Jur/vqD1WKt87Wx6tr8/9Mu1pwjx8WaGZAHJ5vwgHpOV2qyXPT65OOe5peD/+WcYfWc7rH5Yi1y5JhYc5TfkuL4vOo5nUCqWNtx/H+oay8UC9w3iTX3xFNHg32VOSrvT6ekSF6oDOl2TnSr54RbXhttaJJPqe15v18/Z3amWHI6e+R1yv40ytcBAObYqb/790vvdm9U114oFpb9v2LNeOO8fHfJ37dYYa5Yc3X3ibXoGPn1BgCaL00Tax0Xya/ZN126V6x9cHSSes7OT7LFWsVLcu9xtcvPw1iLPszBlS8/fu8c/md1LcB3vERERFax8RIREVnExktERGQRGy8REZFFbLxEREQWsfESERFZlHCc6D+VfijWHsj9e3VtJEOOOXiiMbHm+OTYjxbBAYBYnxILOtEp1tx58m3iJtSvnlONDCm3/ruSk+RzxolNOUpshQa5c3LkokffR47yvUFrh1yLRcWSicq1wXPKzxd3TpZY0yJM8cTq5dhUTInRuQvy5IMmyc9fAHDiRZwIpld+HXOS4jx+yn5w1ctRLmSmiyVPi/zaCQD5v5WnzJ6YpkeRJI9OfUOtP+S6Xqwd+678el74SzkK53Y5+kWd5esuX7WJiIgsYuMlIiKyiI2XiIjIIjZeIiIii9h4iYiILGLjJSIisoiNl4iIyKKEc7xP1V4t1qLJcnYLAPry5Dyff7Y88sl/7IR80KA87gkAXEpGUBu1ZzIC8jol/wsA7nGFcrFXHrVl+uWcpJMmXw8AmJ5etU6Ao42n65G/LwCApDPPWIvrivUxmo6S3Yw1tYg1V9YYeV2wTT9nipwddsYqWV1l9JzJ0HObjifhl58LlqPkzE23Mq4R+shQx6+MRu1QXueUjDkA9BWkiDVXv5yN7YrIz7NrU/Tfn/C/M+URfh9nyhn+vnxlz+co+X0ASa3yczQRfMdLRERkERsvERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUUJ38/f0iXfml5wsTJiCkB9pjyayd8i39aeXS3fCp75kX6LeawlKBcjyjgtJfbj0kagAYgcrpPXavEm7Rb9tDiRjHijwQhQHiNzoktd6igj0pCuxDXalUhGTB6FCQCIMzZQosZLJozXFysjL83xZnmdEktxtemPrRmQY3Q0SI0LKqNGAcB0yY+/GS9H2py2DrEWHVegnjPlaLdYy/wkQ6ztLJZjpSj6jXrOZLcc6wtny8+1rmI5qpXSqj9H2/L1mGc8fMdLRERkERsvERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUUJx4mqZr4t1mpC+i3mG/5VmWykDIEITpd/LgiNKVbP6emT6zk75dhPeEK+WHMN6DEPtxbnMPIEJydFnuiBiH7OmHLrPw0yyoQX5MgTfQCoj78WGTLa9zvORCSjRHtcYzLFWjRXrrmb9Wlepl+J55UVybUGeVqSNukLACLj5Lgg/ZlLnugTK9WnXLm65Ak6Tn2TXEtVJgwp328AQCQilrKT5HYTvFRuBMuO/Fv1lDk+OcKEgBw16pghT6nrSNMnj6WmczoRERHRqMHGS0REZBEbLxERkUVsvERERBax8RIREVnExktERGRRwnGiX3XK0yMeyv+FuvavFsvxndUbbxdrfUXyrenhbPk2ewDIOChHSMJl8pSh5kvkSUFhebgGAGCcI0eYvE0nxFo0S4ldOPrX6eqQj0uDtMfX3a1PuYpky2s9ciIDjhJDiuRnqufU9OfIsYvkBjnOFstWpiwBcEJyfGIgW46XePyF8jH79UiGt75VrZPOVadPhUNUmbCTmyWWtIldJl9eBwAts+V43kC6/Frm6ZLjd7/4eKp6TicmH9fJlCdgZYzvEGsVWfreTPPorxvx8B0vERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUVsvERERBax8RIREVmUcI7349ZxYs2dr2dNJ3jaxFrfeDnrl7VXvrzOcvWU6Fcyt0cWylndqF/Ovpl8PbsV/aV8vS3XynnHUK58TK8cqQMApFboGTcCjs5PE2vRJLkGAGl1cr4w/B054+soEUpPn3xMABhI0Z9PkuD0TLHm69TPaZQfwaM+JX8Z8isHVU+JMZ8p4zBpkCfhl+hTOOny/tS+NVpWNzRWH/UY88m17nHykyJ1gvz7CEJ9ykEBOF/I+2ggKu/Pbrd8PXuDpeo5EVWeo3P0pQDf8RIREVnFxktERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERkUcL3qgd/XSDWfl2hj4ra1zNBrKXldou11GY56uHv1H9miCgpB1dEvpm+t0A+rlMvx5AAIJIqjzHsmiDfun7xdw6JtcJkfezfm7++RK0TcNN//IVYy/fqj+8T++eLtdwMee+298h7pfOoHmFKGdcp1v79hD+KteMhOUN3oE1+/gJAsEOOiWSm98rrPpef+95uPRYVzpRHHNIgR4sTJZ/54xfNShVrJ8rleE5znKiMO7dPrI3L6RBr9Z/I+zPmU7J5API/kV/P3cpkyv40+et0y9ME45Mn3Z7Ed7xEREQWsfESERFZxMZLRERkERsvERGRRWy8REREFrHxEhERWZRwnCjvYzkqc1fJ36trS8a1irXez+UIRM8SeRqQ6dAnVqTWyT9TFL/TLtaydjSLtdj4seo5QwXy7eme8T1ibVb6UbG2JONj9Zy1ldlqnYCKpCaxNt3XoK5dWCF/zzM8cnSiJSxHhj7yjVfP+cPJO8TaxX75esu8ciTov6VOVM+5J1WO/P3xcLG8MEPOawzEmazjRNxqnXQmKL+OAUD4kgqx1jpTjiJ1zZH39e2Ve9RzXp4qRyPfaL9YrB2NynGivN/o+yTzoBy/c/XJ+9Npl9fFsjPVc7p6Q2o9Hr7jJSIisoiNl4iIyCI2XiIiIovYeImIiCxi4yUiIrKIjZeIiMiihONEUb88aSTvF151bVN5oVhb9O9+K9Z+MnafWHv+hD5t5dcn5FvpP+6pFGuF2+Rb9M3vD6jnTJ1QKtacavkxqC6SayV+OYoFAE+W/Uyp/nd17YXiteaLxNobzix1bXu/HBHr6JMnELV1yNNf0KyMzgLwX7oWi7U5JXViLS+pS6y9eUDe8wCQ9rEcL8lvkqfD+E9ExVpfTpwJYsnyVBkaZNLkfdT23TJ1bbBSfs1OniS/zq2d+p5Ym+k/pp6zLSo/Xz5uHSfWUhrkvZK9T38NhJH3kdMpxzijhXIU09UpR6oAwLj0yVvx8B0vERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUVsvERERBax8RIREVmUcI43/VeHxZrj1XO8AwF5DNpbn8wUa3leOZd4b3a1es7emJyV3PWdSWItOShn43xd+jg39+dyNq5sqzya7sCJqWKt6d/J4+UA4Ceh+WLtd8o0twvJwZ/L329XWF+b3CpnBCMBOcuXH5Szr+E0PQM4cETOQlbvk/eKo8Riszr1zGzeb4LycZURaNF6OdeZUl6qnjNUkqnWCei4JE+sNV0tj2oFAG+KvLknZbeItVKvXKuPZKrn/PHha8TasdocsVb+sTJmLyyP9gMAOMrzySOPFHS3ymMBEZHz6fGOmwi+4yUiIrKIjZeIiMgiNl4iIiKL2HiJiIgsYuMlIiKyiI2XiIjIooTjRMjOFEtGGcsEAGlH5VuzQwfl0Wovp10s1npjPvWcP6+bLtbcHjnq0XypfGt6oF6PTfXm5oq1qDIJLu93vWItVi0fEwBa/8PZ3dZ+IRj/6nGxFslNV9d6WuTIgRNTokY5cgzMc0yO7gBAaPJYseZtl2MXfUXyCLnUz/Rz6hfUL5ZMRIm0NMmxFABI7pb3PQ0KzpBfjyaXyvsaAFI8Spwo0CzW/v4X3xdrvmP6a2BKk3y9xQ1yH/AfVkb/9euZP9Mnj/AzOVlyrUGOeKoRJQCudD3mGQ/f8RIREVnExktERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERkUeJxIm1ag1c/THKjfLt36edyVKGtVr4VfGfsCvWckWL5ZwqPnGCCt1uu9RTqsanucXLNuOW1oWx5Gk3hr+THDgACXyg5JRqk7E/vET3yEmvvkIvJSWLJ7ZLjCGoEB4BrQI67uZvlCVhJXnnPO3GmrcQC8tfiKJONXDOmyAc9psQ1KCHOJPkFKdOvvzZ80ZEt1g78S4VYK/2VvD/9rfLEOAAYSJdfj5IOKftBe74ocTYAgFuOVJomOaZkBuSv063EkADAxJteFAff8RIREVnExktERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERkUcJxInNcnmbhysxQ1zpHGuTjRuXbsjM/+0Ks9X/3IvWcrogcgUhuHRBrPWPlqUfRJP3nlL58OQYydrL8+DXUybf9O7vlYwJATrX8tdCftbTJNa8+bUXbn+qEEmXyTqRFnxTkVaYeIVXOwmlTj0xAjqwBgCsoT2HSOFrUQ4mIAEAsW58MRUBehhwn6h6IEyV8JUc+bqf8upLyhyNizcSZFOQ38nH1MKbCq0+ic9LkqVzo6pGvR9u7fv2c6Duh1+PgO14iIiKL2HiJiIgsYuMlIiKyiI2XiIjIIjZeIiIii9h4iYiILGLjJSIisijhHK/jKGObuvRRUY5HOY2Sl4r1yWOvkv7lgHrOlDw5w4aonDXzdGXKx2zSc3N1C+VMaGOrknU28mPb8NdKRg1A8btnlye7EMTGFYg1d0uHutblV77nymiwgQnyOb3xMoLac00ZcegYOSmp5m0BxHLk/en0ymsdZbSa0fLIAKBH1AnAsZZMsdZ6UJlvCqDsX+Tfn4Be+bVVzXzHGWnp+OVrMuEz+50D0RZ9dKfTIb8GukqLxVpsUpG87k/16jljfSG1Hg/f8RIREVnExktERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERkkWOMkkEgIiKic4rveImIiCw67433hRdegOM42Ldv3zk5nuM4uOuuu87Jsb56zIcffviM1z/wwANYtGgRioqK4DgObrvttm+0vru7G/fccw8KCwuRlJSEWbNmYevWrWd8PXRuXAh7d2BgAGvWrEFpaSn8fj+mTJmCp556KuH13Lsj04Wwd0fz6y7f8Z4DTzzxBILBIK6//nr4fHF+K9FpLF68GBs3bkRVVRXeeecdzJ49G0uXLsXmzZvPw9US/cWKFSvwox/9CCtXrsS7776LG264AXfffTcee+yxhNZz79JwGc2vuwn/ykiSdXV1weUa/BnmxRdf/EZrt2/fjvfffx+bN2/G0qVLAQBXXXUV6urqsHr1atx8881wu93n/JqJDhw4gOeffx6PPvooVq9eDQC48sorEQwGsW7dOvzgBz9AVlaWuJ57l4bTaH7dHRHveEOhEO69917MmjULGRkZyMrKwuWXX4433nhDXPPMM89g0qRJ8Pv9mDZt2mn/iqCxsRHLly9HcXExfD4fysrKsGbNGkTi/L7Rb+rLb/6ZeO211xAIBHDjjTcO+fiyZcvQ0NCAjz766Gwvj86j0bx3X3/9dRhjsGzZsiEfX7ZsGfr6+rBjxw51Pffu6Daa9y4wul93R8Q73v7+frS1teG+++5DUVERwuEwPvjgAyxevBgbNmzALbfcMuTz33zzTezatQtr165Famoq1q9fj6VLl8Lj8WDJkiUABr/5c+bMgcvlwkMPPYTy8nLs2bMH69atQ21tLTZs2KBeU2lpKQCgtrb2fHzJJ1VXV2Pq1KnwfG2QRGVl5cn63Llzz+s10JkbzXu3uroaubm5KCgYOtDhq3sv3nru3dFrNO/dszXse9ecZxs2bDAAzN69exNeE4lEzMDAgLnjjjvMRRddNKQGwCQnJ5vGxsYhnz9lyhRTUVFx8mPLly83gUDA1NXVDVn/4x//2AAwBw4cGHLMqqqqIZ9XXl5uysvLE77mL6Wmpppbb7014c+fOHGiueaaa075eENDgwFgHnvssW98DXRufNv37oIFC8zkyZNPW/P5fOb73/++up57d+T6tu/drxttr7sj4q+aAeCVV17BFVdcgUAgAI/HA6/Xi+effx6ffvrpKZ87f/585Ofnn/x/t9uNm2++GTU1NTh69CgA4O2338ZVV12FwsJCRCKRk38WLlwIANi9e7d6PTU1NaipqTmHX6FMG7mo1WhkGM1792z3Hvfu6Daa9+7ZGs69OyIa77Zt23DTTTehqKgImzZtwp49e7B3717cfvvtCIVOnXv49b8a++rHgsEgAKCpqQlvvfUWvF7vkD/Tp08HALS2tp7Hryhx2dnZJ6/5q9ra2gBAvbmFht9o3rvS3uvp6UE4HI6797h3R7fRvHfP1nDv3RHxb7ybNm1CWVkZXn755SE/afT3n34Ad2Njo/ix7OxsAEBOTg4qKyvx6KOPnvYYhYWFZ3vZ58TMmTOxZcsWRCKRIf/esH//fgDAjBkzhuvSKAGjee/OnDkTW7duRWNj45AX1UT3Hvfu6Daa9+7ZGu69OyLe8TqOA5/PN+Sb39jYKN5dt3PnTjQ1NZ38/2g0ipdffhnl5eUoLi4GACxatAjV1dUoLy/HpZdeesqfkbIBbrjhBnR3d+NnP/vZkI9v3LgRhYWFuOyyy4bpyigRo3nvfu9734PjONi4ceOQj7/wwgtITk7Gtddeq67n3h3dRvPePVvDvXetveP98MMPT3un2nXXXYdFixZh27ZtWLFiBZYsWYL6+no88sgjGDt2LA4dOnTKmpycHFx99dV48MEHT95dd/DgwSG3tq9duxbvv/8+5s6di1WrVmHy5MkIhUKora3F9u3b8fTTT5/cLKdTUVEBAAn9e8Pu3bvR0tICYHAz1tXV4dVXXwUAzJs3D7m5uSevae3atdi5cyfmzZsHAFi4cCEWLFiAO++8E52dnaioqMCWLVuwY8cObNq0iTnIEeDbunenT5+OO+64A1VVVXC73Zg9ezbee+89PPvss1i3bt2Qv27j3h2dvq17Fxjlr7vn9dYt85e766Q/hw8fNsYY8/jjj5vS0lLj9/vN1KlTzXPPPWeqqqrM1y8RgFm5cqVZv369KS8vN16v10yZMsW89NJLp5y7paXFrFq1ypSVlRmv12uysrLMJZdcYu6//37T3d095Jhfv7uupKTElJSUJPQ1zps3T/z6du3adfLzvvx6vvoxY4zp6uoyq1atMgUFBcbn85nKykqzZcuWhM5N58+FsHfD4bCpqqoy48ePNz6fz0yaNMk8+eSTp3we9+7ociHs3dH8usvpRERERBaNiH/jJSIiulCw8RIREVnExktERGQRGy8REZFFbLxEREQWsfESERFZlPAv0Lh20n+Wix2d+mJtDqMj934nyS/WTOj0v9bsL58Qk2tKONrJSJcP2X5CP6fnzH4fiZOSJJ+zp1dfm5ws1t6pe+KMrufb5tq8H4g1JzVFXavtM21/QpsVehYJvliz/LtuXbnZ8sLwgH5g5ZpMdqa8bkB+bhufVz1l37g0sfYvP1deby4gf5P892LNlRZQ10YmjxNrnmb5NTtWe1SsmYGwek73n39pxTflKHvFCL/C8qRM+TXb6VZeP1Pk187Df6f/hq3+KX3K2h+qawG+4yUiIrKKjZeIiMgiNl4iIiKL2HiJiIgsYuMlIiKyiI2XiIjIooTzL04kKtYirUF17ZneYm4G5AiE4/epa2NKDMdRYhexZPm4jssRawDg9MW57V3SL9+i73j1SIbp6jqzc15IlCiNyZWjXIC+77XvmxbBMR79511Xp7J3k5XomRJvcqJKvA6ASU8Va12TM+V12pcSJzUVGsOf++NxKd9vJyB/zwDA9dtP5GJmhlhyj5OjNKarRz0n4sSNxONq65TIKaBHhjrnloq1/nT5uBO+e1g9Z2e//roRD3c+ERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUVsvERERBax8RIREVmUcI431tgsH6SsRF/b1CLWnDJ5dBUa5XVaThcAUFIkn7NDzr4OFMr5NmTIY6QAIOaTf47xdMk5NXddk3xQbaQiAFMqf500yMnKlIvt+kjLWH6WfNy6BrEWPfAnseaeOEE9Jxw9Ly4uU0b0DZToWfqeQjkD3DZVHqMZmSI/D70+fe9GIvy5Py6v8vsKlBx5PCYUkosxJbse08PZ2lhVbW1oYr5Y83bqvx+hP0d+XW6+WN5jGRfJIzYDXv2cNc05aj0e7nwiIiKL2HiJiIgsYuMlIiKyiI2XiIjIIjZeIiIii9h4iYiILEo4TuQakykXQ/qt145PHm0X+9Pn8jqPfHmugjz1nLG6Y2Kta/5UsdY3Ro5OdFaop0Q0Sb5dfvw78jqPFh9RHgMAwHH5lngaZJQRkk6cSIarTY6emTw5UuAeq+zPljb1nFBGQYYrS/W1guaL9DFm3bPkeMmiaR+LtX/K2yXWPuzTY4b//Nl8tU6A45Ffj2Kd+khQxyu/djj5ShymVd6fTrIeqdSicJ2z5XGD3YXy19mbr4+ADRfJYz+XXvR/xNrBLjnC1NGvf53ms4Baj4fveImIiCxi4yUiIrKIjZeIiMgiNl4iIiKL2HiJiIgsYuMlIiKyKPHpRMqt667cbHWtUda6i8aKtWiOMumivUc9pzNevnXduORb3jumyMf863n71XP+9vh4sdZdJE89SqpLFWtOX5yollolAHC0uFuSPJUHAGIZ8vfG1S7v68jYMWLN0ycfEwD6y+SoR2+eHK3ozZd/jk6aL0/6AoD/NW2zWOuIpoi1sR45VjE76Yh6zlBYjk3RnylRTFemMkkNAJQoEpRJVkZ5PTdGn04UHifv+6N/I68tLZfjn+vK3lXPmemSJ2Q9cexvxFp1g9x7Bnr1CNPYav1xiIfveImIiCxi4yUiIrKIjZeIiMgiNl4iIiKL2HiJiIgsYuMlIiKyKOE4kaPELkx3nGiPW7mt/Qw1LJTjQgDgisi3e7vkYRbAuD6xdGJAn/DS3y8/nBndMbHWVy7fvp/8+zr1nIjIsQAaZHrlyTtOmh7tcbV0yEUl6uFp7hRr/aXKZBgAJ0rl51pPsRwgi6TIe35apj7FqsAtR65+3TtRrP1rSH5u/8/d31XPmblf+bn/BnXpBcMoE4a0/QcAsXR5wo67sV1emKK8zmmT1AA0XyyvLSptFGtVE94Sa1luOS4EAPv7i8TaZ8FcsWaOyM/9/D/qcaHM3zWr9Xj4jpeIiMgiNl4iIiKL2HiJiIgsYuMlIiKyiI2XiIjIIjZeIiIii9h4iYiILEo4x9s7p1yspe5v0NdeUibWvF1yqLbpMjln1TVLzmYCgOOSc1ixbjn/luyTc7Gft+n5S683KtaOzZevJ/OAfD3uULF+znY5d0x/poyBNO0n1KVOujz2rr9Ezl+3T5azuCcm6RnBG676jVj7vFveg3+dfUisvVJ/sXrOeTv+H7HmCcjPUf+/yiMDCz+Xnw8AkNKg5zMJcGLK61iKPtLS3RAUa2aMPHI1liy/HrVPV0a1AugtlH9fwZU59WItqgw4fbNzlnrODX+8XKyl/VbOMpfsl3uI73c16jmdFPm4ieA7XiIiIovYeImIiCxi4yUiIrKIjZeIiMgiNl4iIiKL2HiJiIgsSjhOdORm+TZx97zx6lrjlW+J93b6xNrAZDlu8NPL/rd6Tu329DU114u1jj55rFXHcf1W+iVz9oq1znHycfsukm/f/9XvpqrnzNmnRwoIcJRRZiZnjLq2vyhTro2Rv29ts+QozeI5+9Rzrs79lVjbkVIi1o6G5XhTwxd6FK7oQ+UxcuQ9lnFAHjcY8+tj61y98ihCGtR6xdgzXhv1yXvb3yW/JkeVb1vzd/SImCssv5f7Y5s8vu+dz6bL19Oij2PN+61cy/i8W6x5mpQoYbb+uoA+Pc4aD9/xEhERWcTGS0REZBEbLxERkUVsvERERBax8RIREVnExktERGRRwnEixyPHiSZ/p1ZdG4nJ/d3nlm9PX170C7GW5dYnm7RE5clG9V/kirW0Gvkh8WbrU2UOnJBv/d8+ebu6VnJtX5par23To1wERIuUKI0SNQKArnFylKY3X15bUq5P7NJs6Jgl1nY0ThNrR39fKNZyP9HPGTjcKdZcncoELI9bLDkDevTEOdGlXxSheZ48GQpu/fXImyRPWos0y9N1vN3yvvaO0SNgSclhsVZfXSDWMg7J58z4QnkMACQdlyNDTkhZG5N7muk5v5Oz+I6XiIjIIjZeIiIii9h4iYiILGLjJSIisoiNl4iIyCI2XiIiIosSjhO56+UJEZ+589S1F4+vF2slKW1iLdMl39L9h1Cxes7/75NrxFryMfnLTq+TIxBJQf3nlBpHnhwzPypPRFo+frdYu2f8B+o5H5nzt2qdAFe3HIFomidHywCgP0ub2iOva/idHC07EshXz2mUmEjGQXnvjvtE/jo9vXK0BACciBytQEtQXpelTHFpbVLPGYvqcSMCrp5xUKx1RfTJZDVtcozuRLb8WjbglifGmXb9nKY+RawFjstPGFdY3vNaXAgAnCa5hyBDjmOaTuW47jjvSSP68ykevuMlIiKyiI2XiIjIIjZeIiIii9h4iYiILGLjJSIisoiNl4iIyCI2XiIiIosSzvEWfCRn7jqPyyP4AODjw5PF2kdj5OO+M3aqWOvplnPFAJD+G3nsla9Tzoyl1cijypw+eeQVAKS0yJnG1iY5d/xfJ/xHsXbpxTXqOf9N/hdqnYBIlrw/wxn6WEDnsg6xFvo8Xazl/EE+ZlK7kpkFAGXam7dTzrb7GjrkQ56Qx/4BUMcjOoGAWIs1NMrrfHIeFABcWgaYAAC/PS6P/ezp1F8D0eWVa2nyuLz/MPe3Yq01LO8FAPjF7+XX7IJtIbHmPnRUPqhHb1OOS37/aFqUjG9ulliKpemPretz5XoTwHe8REREFrHxEhERWcTGS0REZBEbLxERkUVsvERERBax8RIREVmUcJwo8Kl8W3ZqjX6Y3lI5duEYOTvRl5Up1tL79EhG2kH5eo3XLV9P7TG5Nka+HgBIrZajFclH5dvwW7rl4/4uNlE956cl8oi5//+v1KUXjPap8qiycKaS3QEQDipjzhrln1u9PXJMLmVfnXrOqPI9VWMXmcrzLE60R+WVn9+uzAyxZqL6c9SE5DGGNCj5DfnxzejWH9/eHHl/dsyUo0ZtYTl+t2H8L9VzTq4rE2vB6fJxc0MFYs0oUTcAcH0uj501pYVizTlyXD5mUO4RAICY/roRD9/xEhERWcTGS0REZBEbLxERkUVsvERERBax8RIREVnExktERGRRwnEiZyAiF1367d4puw7Ixy2Vp/akHFLOGU9zq3zOsXnyOkf5WUR7DAB1wouruV2sZX3qF2vJQbkGAB0TM+Xi99SlF4xQjvx9iZbJ034AIPmAEidqkOMcgcPKlCtlmgoAuHrlyTFwy2uj9XIUzjUmziSgfjna4/jlKFIsTz6uq6tPPyfjRHFlHegWa6EcfYJOWkiOvPQWynGZvqgy1SiO+RM+E2vvTZsl1lKb5Lhl4F8b1HMan3y9LmWaF9LS5GN296jndFLl14VE8B0vERGRRWy8REREFrHxEhERWcTGS0REZBEbLxERkUVsvERERBYlHCcynUo8IjlZXetkyZEDo0wncvrkuIEJh/VzJsm32pvWDnldQJ6gYXr16IkWJ3I88kPt/VyZkhHKUU+Z3JTwt/CCpaUjoh361B5HGQCTFJTjZU63EqVx65NPTLJ8wY4y8celxCOQJU+5AQAcb5avp0f+WtSf3ONMlYHynKBB7tZOsZba3KGujeZlijVfh7xXajrk15wdvXq8Mc0TEmsxv/xan9yovLZ64kwKUqZymQ758XO8yvNM6QPA2U/W4jteIiIii9h4iYiILGLjJSIisoiNl4iIyCI2XiIiIovYeImIiCxi4yUiIrIo4SBdZJI8vs/zSW2csyinUfJQJqLkJOONZVLGp5kMJaPV1CbX4uUOY3JOLdreIdbcuXJuzn1MHm8IAC4l10l/psRJnYieNU2vlR/fpCYlexjskGvKmD0AcAflzHxk8jhlnTxCzunWM+imuEAuKntMzeH361n7WMcJtU4AYvJjH2tqUZe6ldejog/k0ZM1+fLr0f0xfdbod4vlsYDGL38tTXPkLG7ePv056m6XR/jFxsn72tWgPH5+fTSiE2cUbjx8x0tERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERkERsvERGRRY7R8gBERER0TvEdLxERkUVsvERERBax8RIREVnExktERGQRGy8REZFFbLxEREQWsfESERFZxMZLRERkERsvERGRRf8X27wytU0gydAAAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 9 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, axs = plt.subplots(3,3)\n",
    "axs = axs.flatten()\n",
    "\n",
    "X,y = next(iter(training_dataloader))\n",
    "for i, ax in enumerate(axs):\n",
    "    ax.imshow(X[i,0].amax(0))\n",
    "    ax.set_title(f\"Label: {y[i]}\")\n",
    "    ax.set_axis_off()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1\n",
      "-------------------------------\n",
      "Accuracy: 40.0, Loss: 0.405724  [   30/   30]\n",
      "Test Error: \n",
      " Accuracy: 50.0%, Avg loss: 24.919770 \n",
      "           Precision: 0.500, Recall: 1.000\n",
      "Epoch 2\n",
      "-------------------------------\n",
      "Accuracy: 76.66666666666667, Loss: 0.828855  [   30/   30]\n",
      "Test Error: \n",
      " Accuracy: 53.3%, Avg loss: 22.108765 \n",
      "           Precision: 0.533, Recall: 1.000\n",
      "Epoch 3\n",
      "-------------------------------\n",
      "Accuracy: 80.0, Loss: 0.543504  [   30/   30]\n",
      "Test Error: \n",
      " Accuracy: 51.7%, Avg loss: 23.350894 \n",
      "           Precision: 0.517, Recall: 1.000\n",
      "Epoch 4\n",
      "-------------------------------\n",
      "Accuracy: 70.0, Loss: 0.260397  [   30/   30]\n",
      "Test Error: \n",
      " Accuracy: 42.5%, Avg loss: 32.415985 \n",
      "           Precision: 0.425, Recall: 1.000\n",
      "Epoch 5\n",
      "-------------------------------\n",
      "Accuracy: 93.33333333333333, Loss: 0.181836  [   30/   30]\n",
      "Test Error: \n",
      " Accuracy: 48.3%, Avg loss: 26.552392 \n",
      "           Precision: 0.483, Recall: 1.000\n",
      "Done!\n"
     ]
    }
   ],
   "source": [
    "out_dir = \"classifier_weights/\"\n",
    "if not os.path.exists(out_dir):\n",
    "    os.makedirs(out_dir, exist_ok=True)\n",
    "\n",
    "lr = 1e-3\n",
    "epochs = 5\n",
    "classifier = models.ResNet(models.ResidualBlock, [3, 4, 6, 3], num_classes=1)\n",
    "classifier = classifier.to(device=DEVICE, dtype=dtype)\n",
    "\n",
    "branch_classifier.train(training_dataloader, test_dataloader, out_dir, lr, epochs, classifier, state_dict=None)\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "tractography",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
